//@ui5-bundle com/sap/bukfiori/Component-preload.js
jQuery.sap.registerPreloadedModules({
"version":"2.0",
"modules":{
	"com/sap/bukfiori/Component.js":function(){sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device","com/sap/bukfiori/model/models"],function(e,t,i){"use strict";return e.extend("com.sap.bukfiori.Component",{metadata:{manifest:"json"},init:function(){e.prototype.init.apply(this,arguments);this.getRouter().initialize();this.setModel(i.createDeviceModel(),"device");var t=document.createElement("script");t.setAttribute("src","https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js");document.head.appendChild(t);var t=document.createElement("script");t.setAttribute("src","https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js");document.head.appendChild(t)}})});
},
	"com/sap/bukfiori/controller/App.controller.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("com.sap.bukfiori.controller.App",{onInit(){}})});
},
	"com/sap/bukfiori/controller/View1.controller.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox"],function(e,t){"use strict";return e.extend("com.sap.bukfiori.controller.View1",{onInit:function(){let e=new sap.ui.model.json.JSONModel({dateValue:new Date("2023/08/15")});this.getView().setModel(e,"oDateModel");let t=new sap.ui.model.json.JSONModel;t.setData({settings:{edit:false},items:[]});this.getView().setModel(t,"oTreeModel");t.refresh(true)},date:function(e){let t=(new Date).getTimezoneOffset();let r=false;if(t>0){r=true}if(e){var i=sap.ui.core.format.DateFormat.getDateTimeInstance({format:"yyyyMMdd"});return i.format(new Date(e),r)}else{return e}},onPressTrigger:function(e){let t=this.getOwnerComponent().getModel();t.create("/trigger",{},{success:function(e){debugger},error:function(e){debugger}})},handleChange:function(e){debugger},onAddNewRow:function(){let e=this.byId("treeTable");this.onLoadDialog().open();if(e.getSelectedIndices().length>0){this.getView().getModel("oTreeModel").setProperty("/settings/edit/",true);this.onLoadDialog().setTitle("Add New Child Node");this.sMaterialGroupForNewChild=e.getContextByIndex(e.getSelectedIndices()[0]).getObject().MaterialGroup;this.ParentNodeForNewChild="";if(e.getContextByIndex(e.getSelectedIndices()[0]).getObject().ParentNodeID){this.ParentNodeForNewChild=e.getContextByIndex(e.getSelectedIndices()[0]).getObject().ParentNodeID}else{this.ParentNodeForNewChild=e.getContextByIndex(e.getSelectedIndices()[0]).getObject().NodeID}}else{this.getView().getModel("oTreeModel").setProperty("/settings/edit/",false);this.onLoadDialog().setTitle("Add New Parent Node")}this.getView().getModel("oTreeModel").refresh(true)},onAddDialogAddButtonPress:function(){let e=this.getView().getModel("oTreeModel");let t=this.byId("treeTable");let r="";if(t.getSelectedIndices().length>0){r=this.sMaterialGroupForNewChild}let i=e.getData().items;i.push({MaterialNumber:"",MaterialGroup:r,MaterialDesc:"",UnitOfMeasure:"",UnitPrice:"",Currency:"",Quantity:""});e.setProperty("/items/",i);e.refresh(true)},onDelDialogItemPress:function(e){let t=this.getView().getModel("oTreeModel");var r=e.getSource().getParent().getBindingContext("oTreeModel").getPath();var i=r.charAt(r.length-1);let o=t.getData().items;o.splice(i,1);t.setProperty("/items/",o)},onEditRow:function(){},getNewNodeID:function(){let e=this.getOwnerComponent().getModel();return new Promise(function(t,r){e.callFunction("/getNewNodeID",{urlParameters:{matGroup:""},success:function(e){t(e);debugger},error:function(e){r(e);debugger}})})},createNewEntry:function(e){let r=this.getOwnerComponent().getModel();let i=this.getView();i.setBusy(true);return new Promise(function(o,a){r.create("/Materials",e,{success:function(e){i.setBusy(false);t.success("Created");o(e);debugger},error:function(e){i.setBusy(false);a(e);debugger}})})},onAddDiaglogSave:async function(){let e;let t=false;let r;if(this.getView().getModel("oTreeModel").getData().settings.edit===false){t=true}r=this.getView().getModel("oTreeModel").getData().items;if(t){for(let t=0;t<r.length;t++){debugger;e=await this.getNewNodeID();e=e.getNewNodeID;let i={NodeID:e,ParentNodeID:null,DrillState:"expanded",HierarchyLevel:"0",MaterialNumber:"",MaterialGroup:r[t].MaterialGroup,MaterialDesc:"",UnitOfMeasure:"",UnitPrice:0,Currency:"",Quantity:"",Total:0};let o=await this.createNewEntry(i)}}else{e=await this.getNewNodeID();e=e.getNewNodeID;for(let t=0;t<r.length;t++){let i={NodeID:e,ParentNodeID:this.ParentNodeForNewChild,DrillState:"leaf",HierarchyLevel:"1",MaterialNumber:r[t].MaterialNumber,MaterialGroup:r[t].MaterialGroup,MaterialDesc:r[t].MaterialDesc,UnitOfMeasure:r[t].UnitOfMeasure,UnitPrice:parseFloat(r[t].UnitPrice),Currency:r[t].Currency,Quantity:r[t].Quantity.toString(),Total:0};let o=await this.createNewEntry(i)}}this.onLoadDialog().close()},onAddDiaglogCancel:function(){this.onLoadDialog().close();let e=this.getView().getModel("oTreeModel");e.setProperty("/items/",[])},onLoadDialog:function(){if(!this.addDialog){this.addDialog=sap.ui.xmlfragment("com.sap.bukfiori.view.NewEntry",this);this.getView().addDependent(this.addDialog)}return this.addDialog},onDownloadTemplate:function(){let e=[{MaterialNumber:"",MaterialGroup:"",MaterialDesc:"",UnitOfMeasure:"",UnitPrice:0,Currency:"",Quantity:""}];const t=XLSX.utils.json_to_sheet(e);const r=XLSX.utils.book_new();XLSX.utils.book_append_sheet(r,t);XLSX.writeFile(r,"NewTemplate.xlsx",{compression:true})},onUpload:function(e){debugger;this._import(e.getParameter("files")&&e.getParameter("files")[0])},_import:function(e){debugger;var r=this;var i={};if(e&&window.FileReader){var o=new FileReader;o.onload=function(e){var o=e.target.result;var a=XLSX.read(o,{type:"binary"});a.SheetNames.forEach(function(e){i=XLSX.utils.sheet_to_row_object_array(a.Sheets[e])});var n=i.reduce((e,t)=>{const{MaterialGroup:r}=t;e[r]=e[r]??[];e[r].push(t);return e},{});let l=Object.keys(n);let s=[];let d=0;for(let e=0;e<l.length;e++){d=d+1;let t={NodeID:d.toString(),ParentNodeID:null,DrillState:"expanded",HierarchyLevel:"0",MaterialNumber:"",MaterialGroup:l[e],MaterialDesc:"",UnitOfMeasure:"",UnitPrice:0,Currency:"",Quantity:"",Total:0};let r=t.NodeID;s.push(t);for(let t=0;t<i.length;t++){if(l[e]==i[t].MaterialGroup){d=d+1;let e={NodeID:d.toString(),ParentNodeID:r,DrillState:"leaf",HierarchyLevel:"1",MaterialNumber:i[t].MaterialNumber,MaterialGroup:i[t].MaterialGroup,MaterialDesc:i[t].MaterialDesc,UnitOfMeasure:i[t].UnitOfMeasure,UnitPrice:parseFloat(i[t].UnitPrice),Currency:i[t].Currency,Quantity:i[t].Quantity.toString(),Total:0};s.push(e)}}}let u=r.getOwnerComponent().getModel();r.getView().setBusy(true);for(let e=0;e<s.length;e++){u.create("/Materials",s[e],{success:function(t){r.getView().setBusy(false);if(e==s.length-1){sap.m.MessageToast.show("Created all 1000+ Records Successully")}},error:function(e){r.getView().setBusy(false);t.error("Error while creating Tree record")}})}};o.onerror=function(e){console.log(e)};o.readAsBinaryString(e)}}})});
},
	"com/sap/bukfiori/i18n/i18n.properties":'# This is the resource bundle for com.sap.bukfiori\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Book\n\n#YDES: Application description\nappDescription=A Fiori application.\n#XTIT: Main view title\ntitle=Book\n\nflpTitle=BUK\n\nflpSubtitle=\n',
	"com/sap/bukfiori/manifest.json":'{"_version":"1.49.0","sap.app":{"id":"com.sap.bukfiori","type":"application","i18n":"i18n/i18n.properties","applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.10.4","toolsId":"8eddedd2-b1e7-4466-8c52-a6a30e7863cf"},"dataSources":{"mainService":{"uri":"v2/odata/v4/catalog/","type":"OData","settings":{"annotations":[],"localUri":"localService/metadata.xml","odataVersion":"2.0"}}},"crossNavigation":{"inbounds":{"com-sap-bukfiori-inbound":{"signature":{"parameters":{},"additionalParameters":"allowed"},"semanticObject":"buk","action":"manage","title":"{{flpTitle}}","subTitle":"{{flpSubtitle}}","icon":""}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.116.0","libs":{"sap.m":{},"sap.ui.core":{},"sap.f":{},"sap.suite.ui.generic.template":{},"sap.ui.comp":{},"sap.ui.generic.app":{},"sap.ui.table":{},"sap.ushell":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"com.sap.bukfiori.i18n.i18n"}},"":{"dataSource":"mainService","preload":true,"settings":{"synchronizationMode":"None","operationMode":"Server","autoExpandSelect":true,"earlyRequests":true,"defaultBindingMode":"TwoWay","useBatch":true}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"XML","async":true,"viewPath":"com.sap.bukfiori.view","controlAggregation":"pages","controlId":"app","clearControlAggregation":false},"routes":[{"name":"RouteView1","pattern":":?query:","target":["TargetView1"]}],"targets":{"TargetView1":{"viewType":"XML","transition":"slide","clearControlAggregation":false,"viewId":"View1","viewName":"View1"}}},"rootView":{"viewName":"com.sap.bukfiori.view.App","type":"XML","async":true,"id":"App"}},"sap.cloud":{"public":true,"service":"TRGER"}}',
	"com/sap/bukfiori/model/models.js":function(){sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
},
	"com/sap/bukfiori/view/App.view.xml":'<mvc:View controllerName="com.sap.bukfiori.controller.App"\n    xmlns:html="http://www.w3.org/1999/xhtml"\n    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"\n    xmlns="sap.m"><App id="app"></App></mvc:View>\n',
	"com/sap/bukfiori/view/NewEntry.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n><Dialog showHeader="true"><HBox><Button text="Add New Row" icon="sap-icon://add" press="onAddDialogAddButtonPress"/></HBox><Panel><Table id="idAddTable" class="sapUiSizeCompact" mode="None" items="{oTreeModel>/items/}"\n\t\t\t\tselectionChange="onAddNominationTableRowPress" rememberSelections="true"><columns><Column><Text text="Material Group"/></Column><Column><Text text="Material Number"/></Column><Column><Text text="Material Description"/></Column><Column><Text text="Quantity"/></Column><Column><Text text="Unit"/></Column><Column><Text text="Price"/></Column><Column ><Text text="Currency"/></Column><Column ><Text text=""/></Column></columns><items><ColumnListItem><cells><Input value="{oTreeModel>MaterialGroup}" editable="{=${oTreeModel>/settings/edit}=== true ? false : true }"/><Input value="{oTreeModel>MaterialNumber}" editable="{oTreeModel>/settings/edit}"/><Input value="{oTreeModel>MaterialDesc}" editable="{oTreeModel>/settings/edit}"/><Input value="{oTreeModel>Quantity}" editable="{oTreeModel>/settings/edit}"/><Input value="{oTreeModel>UnitOfMeasure}" editable="{oTreeModel>/settings/edit}"/><Input value="{oTreeModel>UnitPrice}" editable="{oTreeModel>/settings/edit}"/><Input value="{oTreeModel>Currency}" editable="{oTreeModel>/settings/edit}"/><Button icon="sap-icon://delete"  press="onDelDialogItemPress"/></cells></ColumnListItem></items></Table></Panel><buttons class="sapUiSizeCompact"><Button\n                text="Save"\n                class="sapUiSizeCompact"\n                press="onAddDiaglogSave"\n                type="Transparent"\n            /><Button\n                text="Cancel"\n                class="sapUiSizeCompact"\n                press="onAddDiaglogCancel"\n                type="Transparent"\n            /></buttons></Dialog></core:FragmentDefinition>\n',
	"com/sap/bukfiori/view/View1.view.xml":'<mvc:View\n    controllerName="com.sap.bukfiori.controller.View1"\n    xmlns:mvc="sap.ui.core.mvc"\n    displayBlock="true"\n    xmlns="sap.ui.table"\n    xmlns:m="sap.m"\n    xmlns:u="sap.ui.unified"\n><m:Page\n        id="page"\n        title="Tree Table"\n    ><m:content><m:HBox><m:Button\n                    text="Add"\n                    press="onAddNewRow"\n                /><m:Button\n                    text="Edit"\n                    press="onEditRow"\n                /><m:Button\n                    text="Delete"\n                    press="onDeleteRow"\n                /><m:Button\n                    text="Download Template"\n                    press="onDownloadTemplate"\n                /><u:FileUploader\n                    id="FileUploaderId"\n                    sameFilenameAllowed="true"\n                    iconOnly="false"\n                    buttonOnly="true"\n                    fileType="XLSX,xlsx"\n                    icon="sap-icon://upload"\n                    iconFirst="true"\n                    style="Emphasized"\n                    change="onUpload"\n                /></m:HBox><TreeTable\n                id="treeTable"\n                selectionMode="Single"\n                enableColumnReordering="false"\n                expandFirstLevel="false"\n                rows="{\n            path : \'/Materials\',\n            parameters : {\n                countMode: \'Inline\',\n                treeAnnotationProperties : {\n                    hierarchyLevelFor : \'HierarchyLevel\',\n                    hierarchyNodeFor : \'NodeID\',\n                    hierarchyParentNodeFor : \'ParentNodeID\',\n                    hierarchyDrillStateFor : \'DrillState\'\n                }\n            }\n        }"\n            ><columns><Column label="HierarchyLevel"><template><m:Text\n                                text="{HierarchyLevel}"\n                                wrapping="false"\n                            /></template></Column><Column label="NodeID"><template><m:Text\n                                text="{NodeID}"\n                                wrapping="false"\n                            /></template></Column><Column label="ParentNodeID"><template><m:Text\n                                text="{ParentNodeID}"\n                                wrapping="false"\n                            /></template></Column><Column label="MaterialGroup"><template><m:Text\n                                text="{MaterialGroup}"\n                                wrapping="false"\n                            /></template></Column><Column label="MaterialNumber"><template><m:Text\n                                text="{MaterialNumber}"\n                                wrapping="false"\n                            /></template></Column><Column label="MaterialDesc"><template><m:Text\n                                text="{MaterialDesc}"\n                                wrapping="false"\n                            /></template></Column><Column label="Quantity"><template><m:Text\n                                text="{Quantity}"\n                                wrapping="false"\n                            /></template></Column><Column label="UnitOfMeasure"><template><m:Text\n                                text="{UnitOfMeasure}"\n                                wrapping="false"\n                            /></template></Column><Column label="UnitPrice"><template><m:Text\n                                text="{UnitPrice}"\n                                wrapping="false"\n                            /></template></Column><Column label="Currency"><template><m:Text\n                                text="{Currency}"\n                                wrapping="false"\n                            /></template></Column><Column label="Total"><template><m:Text\n                                text="{Total}"\n                                wrapping="false"\n                            /></template></Column></columns></TreeTable></m:content></m:Page></mvc:View>\n'
}});
